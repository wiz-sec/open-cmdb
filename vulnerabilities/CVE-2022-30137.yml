title: FabricScape (CVE-2022-30137)
slug: CVE-2022-30137
cves:
- CVE-2022-30137
affectedPlatforms:
- Azure
affectedServices:
- Azure Service Fabric
image: https://cdn.techcommunity.microsoft.com/lithium/ServiceFabric/ServiceFabric.PNG
severity: Medium
discoveredBy:
  name: Aviv Sasson
  org: Palo Alto
  domain: https://www.paloaltonetworks.com/
  twitter: null
disclosedAt: 2021/06/14
exploitabilityPeriod: null
knownITWExploitation: false
summary: |
    The vulnerability enables a bad actor, with access to a compromised container, to escalate privileges and gain control of the resource’s host SF node and the entire cluster.
    Though the bug exists on both Operating System (OS) platforms, it is only exploitable on Linux;
    Users can check their current Service Fabric version by navigating to their Service Fabric cluster in the Azure console and then, click on “Fabric upgrades”.
    In case the Fabric upgrade mode is configured to “Automatic”, their cluster will be upgraded automatically to the latest version.
    If Fabric upgrade mode is configured to “Manual”, cutomers should update it manually to the latest version (9.0.1035.1 or higher)
manualRemediation: |
  Yes (when auto-updates are disabled)
detectionMethods: Linux Service Fabric runtime < 9.0.1035.1
contributor: a10ns
references:
- https://msrc-blog.microsoft.com/2022/06/28/azure-service-fabric-privilege-escalation-from-containerized-workloads-on-linux/
- https://unit42.paloaltonetworks.com/fabricscape-cve-2022-30137/

