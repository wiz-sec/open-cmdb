title: Microsoft Azure Site Recovery DLL Hijacking
slug: azure-site-dll-hijacking
cves: CVE-2022-33675
affectedPlatforms:
- Azure
affectedServices:
- Azure Site Recovery
image: https://files.slack.com/files-pri/TSYNK6AJ3-F03TZV8PUJC/b70b80cc-e5b2-4d02-9445-eb157dd6c06e_progress_image_99.webp
severity: High
discoveredBy: 
  name: James Sebree
  org: Tenable
  domain: https://medium.com/tenable-techblog/
  twitter: null
publishedAt: 2022/07/12
disclosedAt: 2022/04/08
exploitabilityPeriod: null
knownITWExploitation: false
summary: |
  The Microsoft Azure Site Recovery suite contains a DLL hijacking flaw that allows for privilege escalation from any low privileged user to SYSTEM. 
  Incorrect permissions on the service's executable directory (E:\Program Files (x86)\Microsoft Azure Site Recovery\home\svsystems\transport\) 
  allow new files to be created by any user. 
  The service launched from this directory runs automatically and with SYSTEM privileges and attempts to load several DLLs from this directory. 
  This allows for a DLL hijacking/planting attack via several libraries that are attempted to be loaded from this location when the service is launched.
manualRemediation: |
  None required
detectionMethods: null
contributer: https://github.com/mer-b
references:
- https://medium.com/tenable-techblog/microsoft-azure-site-recovery-dll-hijacking-cd8cc34ef80c
- https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-33675
- https://www.tenable.com/security/research/tra-2022-26
- https://msrc-blog.microsoft.com/2022/07/12/microsoft-mitigates-azure-site-recovery-vulnerabilities/
